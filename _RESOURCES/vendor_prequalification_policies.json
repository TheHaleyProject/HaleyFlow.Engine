{
  "policy_name": "vendorprequalification.policy",
  "for": { "definition": "vendorprequalification", "version": 1 },
  "params": [
    { "code": "PARAMS.PREQ.EVAL.APPROVAL", "data": { "approval": { "selector": { "mode": "role", "value": "preq_evaluators" }, "types": { "technical": { "rule": "all" }, "nontechnical": { "rule": "any" } } } } },
    { "code": "PARAMS.PREQ.TECH.REVIEW.APPROVAL", "data": { "approval": { "rule": "any", "selector": { "mode": "role", "value": "workitem_reviewers" } } } },
    { "code": "PARAMS.PREQ.TIER.VALIDATE.APPROVAL", "data": { "approval": { "rule": "any", "selector": { "mode": "role", "value": "tier_validators" } } } }
  ],
  "rules": [
    { "state": "FormTierCalculation", "complete": { "success": 1001 }, "emit": [ { "event": "APP.PREQ.FORM.TIER.CALC", "complete": { "success": 1001 } } ] },
    { "state": "WorkflowSelection", "complete": { "success": 1002 }, "emit": [ { "event": "APP.PREQ.WF.SELECTION.REQUIRED", "complete": { "success": 1002 } } ] },
    { "state": "UnderEvaluation", "params": ["PARAMS.PREQ.EVAL.APPROVAL"], "complete": { "success": 1004, "failure": 1003 }, "emit": [ { "event": "APP.PREQ.EVAL.DECISION.REQUIRED", "complete": { "success": 1004, "failure": 1003 } } ] },
    { "state": "Overdue", "via": 1006, "emit": [ { "event": "APP.PREQ.EVAL.OVERDUE.ENTER" } ] },
    { "state": "Overdue", "via": 1007, "emit": [ { "event": "APP.PREQ.EVAL.OVERDUE.REMIND" } ] },
    { "state": "PendingClarification", "emit": [ { "event": "APP.PREQ.CLARIF.REQUESTED" } ] },
    { "state": "PendingClarification", "auto": [ { "event": 1005 } ] },
    { "state": "ClarificationCompilation", "complete": { "success": 1012, "failure": 1009 }, "emit": [ { "event": "APP.PREQ.CLARIF.COMPILATION.DECIDE", "complete": { "success": 1012, "failure": 1009 } } ] },
    { "state": "ReturnedToVendor", "emit": [ { "event": "APP.PREQ.VENDOR.ACTION.REQUIRED" } ] },
    { "state": "ClarificationReviewed", "complete": { "success": 1013, "failure": 1014 }, "emit": [ { "event": "APP.PREQ.WORKFLOW.TYPE.DECIDE", "complete": { "success": 1013, "failure": 1014 } } ] },
    { "state": "WorkItemsReview", "params": ["PARAMS.PREQ.TECH.REVIEW.APPROVAL"], "complete": { "success": 1015 }, "emit": [ { "event": "APP.PREQ.TECH.REVIEW.REQUIRED", "complete": { "success": 1015 } } ] },
    { "state": "CompanyTierCalculation", "complete": { "success": 1016, "failure": 1017 }, "emit": [ { "event": "APP.PREQ.TIER.CALC", "complete": { "success": 1016, "failure": 1017 } } ] },
    { "state": "TierValidation", "params": ["PARAMS.PREQ.TIER.VALIDATE.APPROVAL"], "complete": { "success": 1018, "failure": 1019 }, "emit": [ { "event": "APP.PREQ.TIER.VALIDATION.REQUIRED", "complete": { "success": 1018, "failure": 1019 } } ] },
    { "state": "CompanyTierChanged", "emit": [ { "event": "APP.PREQ.TIER.CHANGED.ACK.REQUIRED" } ] }
  ],
  "timeouts": [
    { "state": "UnderEvaluation", "timeout": "P7D", "timeout_event": 1006 },
    { "state": "Overdue", "timeout": "P1D", "timeout_event": 1007, "timeout_mode": "repeat" },
    { "state": "PendingClarification", "timeout": "P2D", "timeout_event": 1010 },
    { "state": "TierValidation", "timeout": "P2D" }
  ]
}
